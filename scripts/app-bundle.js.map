{"version":3,"sources":["app.js","environment.js","failed-build-overview.js","main.js","running-build-overview.js","anticorruptionlayer/teamcity-build-adapter.js","communicationlayer/http-client-router.js","elements/build-overview.js","resources/index.js","services/build-service.js","communicationlayer/teamcitystub/team-city-http-client-stub.js","communicationlayer/teamcitystub/team-city-latest-builds-response.js","communicationlayer/teamcitystub/team-city-latest-running-builds-response.js","/Users/Rob/buildradiator/src/app.html","/Users/Rob/buildradiator/src/css/custom.css","/Users/Rob/buildradiator/src/failed-build-overview.html","/Users/Rob/buildradiator/src/running-build-overview.html","/Users/Rob/buildradiator/src/elements/build-overview.html"],"names":["App","configureRouter","config","router","title","map","route","name","moduleId","debug","testing","FailedBuildOverview","service","activate","params","setAllFailedBuilds","getAllFailedBuilds","baseUrl","then","builds","bind","setInterval","configure","Promise","warnings","wForgottenReturn","aurelia","use","standardConfiguration","feature","developmentLogging","plugin","start","setRoot","RunningBuildOverview","buildService","setAllRunningBuilds","getAllLatestRunningBuilds","fetchBuildArray","clientRouter","url","init","method","headers","Headers","fetch","response","json","jsonResponse","buildType","filter","buildTypeElement","build","length","number","status","statusText","TeamcityBuildAdapter","getAllLatestFinishedBuilds","HttpClientRouter","realHttpClient","teamCityHttpClientStub","includes","BuildOverview","getBuildStatusCssClass","Error","getDrawAttentionCssClass","drawAttention","BuildService","teamcityBuildAdapter","all","latestFinishedBuilds","buildArrays","latestRunningBuilds","validateFailedBuilds","validateRunningBuilds","finishedBuild","failedBuild","isNewBuildRunning","getCorrespondingBuild","latestRunningBuild","undefined","buildNumber","haveDuplicateNamesInBuildArray","buildArray","failedBuild1","failedBuild2","occurancesOfName","TeamCityHttpClientStub","resolve"],"mappings":";;;;;;;;;;;;;MAAaA,cAAAA;;;;;kBACXC,2CAAgBC,QAAQC,QAAQ;AAC9B,WAAKA,MAAL,GAAcA,MAAd;AACAD,aAAOE,KAAP,GAAe,mBAAf;AACAF,aAAOG,GAAP,CAAW,CACT,EAAEC,OAAO,iBAAT,EAA4BC,MAAM,sBAAlC,EAA0DC,UAAU,uBAApE,EADS,EAET,EAAEF,OAAO,kBAAT,EAA6BC,MAAM,wBAAnC,EAA6DC,UAAU,wBAAvE,EAFS,CAAX;AAID;;;;;;;;;;;oBCRY;AACbC,WAAO,IADM;AAEbC,aAAS;AAFI;;;;;;;;;;;;;;;;;;MCIFC,8BAAAA,8BADZ;AAEC,iCAAYC,OAAZ,EAAqB;AAAA;;AACnB,WAAKA,OAAL,GAAeA,OAAf;AACD;;kCAEDC,6BAASC,QAAQ;AACf,eAASC,kBAAT,CAA4BD,MAA5B,EAAoC;AAAA;;AAClC,aAAKF,OAAL,CACGI,kBADH,CACsBF,OAAOG,OAD7B,EAEGC,IAFH,CAEQ,kBAAU;AAAE,gBAAKC,MAAL,GAAcA,MAAd;AAAuB,SAF3C;AAGD;;AAEDJ,yBAAmBK,IAAnB,CAAwB,IAAxB,EAA8BN,MAA9B;AACAO,kBAAYN,mBAAmBK,IAAnB,CAAwB,IAAxB,CAAZ,EAA2C,KAA3C,EAAkDN,MAAlD;AACD;;;;;;;;;;;UCRaQ,YAAAA;;;;;;;;;;AANhBC,UAAQrB,MAAR,CAAe;AACbsB,cAAU;AACRC,wBAAkB;AADV;AADG,GAAf;;AAMO,WAASH,SAAT,CAAmBI,OAAnB,EAA4B;AACjCA,YAAQC,GAAR,CACGC,qBADH,GAEGC,OAFH,CAEW,WAFX;;AAIA,QAAI,sBAAYpB,KAAhB,EAAuB;AACrBiB,cAAQC,GAAR,CAAYG,kBAAZ;AACD;;AAED,QAAI,sBAAYpB,OAAhB,EAAyB;AACvBgB,cAAQC,GAAR,CAAYI,MAAZ,CAAmB,iBAAnB;AACD;;AAEDL,YAAQM,KAAR,GAAgBd,IAAhB,CAAqB;AAAA,aAAMQ,QAAQO,OAAR,EAAN;AAAA,KAArB;AACD;;;;;;;;;;;;;;;;;;MCpBYC,+BAAAA,+BADZ;AAEC,kCAAYC,YAAZ,EAA0B;AAAA;;AACxB,WAAKA,YAAL,GAAoBA,YAApB;AACD;;mCAEDtB,6BAASC,QAAQ;AACf,eAASsB,mBAAT,CAA6BtB,MAA7B,EAAqC;AAAA;;AACnC,aAAKqB,YAAL,CACGE,yBADH,CAC6BvB,OAAOG,OADpC,EAEGC,IAFH,CAEQ,kBAAU;AAAE,gBAAKC,MAAL,GAAcA,MAAd;AAAuB,SAF3C;AAGD;;AAEDiB,0BAAoBhB,IAApB,CAAyB,IAAzB,EAA+BN,MAA/B;AACAO,kBAAYe,oBAAoBhB,IAApB,CAAyB,IAAzB,CAAZ,EAA4C,KAA5C,EAAmDN,MAAnD;AACD;;;;;;;;;;;;;;;;;;;;;ACfH,WAASwB,eAAT,CAAyBC,YAAzB,EAAuCC,GAAvC,EAA4C;AAC1C,QAAIC,OAAO;AACTC,cAAQ,KADC;AAETC,eAAS,IAAIC,OAAJ,CAAY;AACnB,kBAAU,kBADS;AAEnB,4BAAoB;AAFD,OAAZ;AAFA,KAAX;;AAQA,WAAOL,aAAaM,KAAb,CAAmBL,GAAnB,EAAwBC,IAAxB,EACJvB,IADI,CACC;AAAA,aAAY4B,SAASC,IAAT,EAAZ;AAAA,KADD,EAEJ7B,IAFI,CAEC;AAAA,aACJ8B,aAAaC,SAAb,CACGC,MADH,CACU;AAAA,eAAoBC,iBAAiBhC,MAAjB,CAAwBiC,KAAxB,CAA8BC,MAA9B,GAAuC,CAA3D;AAAA,OADV,EAEGhD,GAFH,CAEO,4BAAoB;AACvB,eAAO;AACL,kBAAQ8C,iBAAiB5C,IADpB;AAEL,yBAAe4C,iBAAiBhC,MAAjB,CAAwBiC,KAAxB,CAA8B,CAA9B,EAAiCE,MAF3C;AAGL,oBAAUH,iBAAiBhC,MAAjB,CAAwBiC,KAAxB,CAA8B,CAA9B,EAAiCG,MAHtC;AAIL,wBAAcJ,iBAAiBhC,MAAjB,CAAwBiC,KAAxB,CAA8B,CAA9B,EAAiCI,UAJ1C;AAKL,2BAAiB;AALZ,SAAP;AAOD,OAVH,CADI;AAAA,KAFD,CAAP;AAeD;;MAGYC,+BAAAA,+BADZ;AAEC,kCAAYlB,YAAZ,EAA0B;AAAA;;AACxB,WAAKA,YAAL,GAAoBA,YAApB;AACD;;mCAEDmB,iEAA2BzC,SAAS;AAClC,UAAIuB,MAAM,YAAYvB,OAAZ,GAAsB,oLAAhC;AACA,aAAOqB,gBAAgB,KAAKC,YAArB,EAAmCC,GAAnC,CAAP;AACD;;mCAEDH,+DAA0BpB,SAAS;AACjC,UAAIuB,MAAM,YAAYvB,OAAZ,GAAsB,mLAAhC;AACA,aAAOqB,gBAAgB,KAAKC,YAArB,EAAmCC,GAAnC,CAAP;AACD;;;;;;;;;;;;;;;;;;;;;QCtCUmB,2BAAAA,2BADZ;AAEG,kCAAYC,cAAZ,EAA4BC,sBAA5B,EAAoD;AAAA;;AAChD,iBAAKD,cAAL,GAAsBA,cAAtB;AACA,iBAAKC,sBAAL,GAA8BA,sBAA9B;AACH;;mCAEDhB,uBAAML,KAAKC,MAAM;AACb,mBAAOD,IAAIsB,QAAJ,CAAa,MAAb,IAAuB,KAAKD,sBAAL,CAA4BhB,KAA5B,CAAkCL,GAAlC,CAAvB,GAAgE,KAAKoB,cAAL,CAAoBf,KAApB,CAA0BL,GAA1B,EAA+BC,IAA/B,CAAvE;AACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QCXQsB,wBAAAA;;;;;;;gCAGTC,yDAAuBZ,OAAO;AAC1B,gBAAIA,MAAMG,MAAN,KAAiB,SAArB,EAAgC;AAC5B,uBAAO,eAAP;AACH;AACD,gBAAIH,MAAMG,MAAN,KAAiB,SAArB,EAAgC;AAC5B,uBAAO,cAAP;AACH;AACD,kBAAM,IAAIU,KAAJ,CAAU,sBAAsBb,MAAMG,MAA5B,GAAqC,cAA/C,CAAN;AACH;;gCAEDW,6DAAyBd,OAAO;AAC5B,gBAAIA,MAAMe,aAAN,KAAwB,IAA5B,EAAkC;AAC9B,uBAAO,gBAAP;AACH;AACD,gBAAIf,MAAMe,aAAN,KAAwB,KAA5B,EAAmC;AAC/B,uBAAO,EAAP;AACH;AACD,kBAAM,IAAIF,KAAJ,CAAU,wBAAwBb,MAAMe,aAA9B,GAA8C,cAAxD,CAAN;AACH;;;;;;;;;;;;;;UCvBW7C,YAAAA;AAAT,WAASA,SAAT,CAAmBpB,MAAnB,EAA2B,CAEjC;;;;;;;;;;;;;;;;;;QCEYkE,uBAAAA,uBADZ;AAEG,8BAAYC,oBAAZ,EAAkC;AAAA;;AAC9B,iBAAKA,oBAAL,GAA4BA,oBAA5B;AACH;;+BAEDrD,iDAAmBC,SAAS;AACxB,mBAAOM,QAAQ+C,GAAR,CAAY,CAAC,KAAKD,oBAAL,CAA0BX,0BAA1B,CAAqDzC,OAArD,CAAD,EAAgE,KAAKoD,oBAAL,CAA0BhC,yBAA1B,CAAoDpB,OAApD,CAAhE,CAAZ,EACFC,IADE,CACG,uBAAe;;AAEjB,oBAAIqD,uBAAuBC,YAAY,CAAZ,CAA3B;AACA,oBAAIC,sBAAsBD,YAAY,CAAZ,CAA1B;;AAEAE;AACAC;;AAEA,uBAAOJ,qBACFrB,MADE,CACK;AAAA,2BAAiB0B,cAAcrB,MAAd,KAAyB,SAA1C;AAAA,iBADL,EAEFlD,GAFE,CAEE,uBAAe;AAChBwE,gCAAYV,aAAZ,GAA4BW,mBAA5B;AACA,2BAAOD,WAAP;;AAEA,6BAASC,iBAAT,GAA6B;;AAEzB,iCAASC,qBAAT,GAAiC;AAC7B,mCAAON,oBAAoBvB,MAApB,CAA2B;AAAA,uCAAsB8B,mBAAmBzE,IAAnB,KAA4BsE,YAAYtE,IAA9D;AAAA,6BAA3B,EAA+F,CAA/F,CAAP;AACH;;AAED,+BAAOwE,4BAA4BE,SAA5B,IAAyCF,wBAAwBG,WAAxB,GAAsCL,YAAYK,WAAlG;AACH;AACJ,iBAdE,CAAP;;AAgBA,yBAASR,oBAAT,GAAgC;AAC5B,wBAAIS,+BAA+BZ,oBAA/B,CAAJ,EAA0D;AACtD,8BAAM,IAAIN,KAAJ,CAAU,wGAAV,CAAN;AACH;AACJ;;AAED,yBAASU,qBAAT,GAAiC;AAC7B,wBAAIQ,+BAA+BV,mBAA/B,CAAJ,EAAyD;AACrD,8BAAM,IAAIR,KAAJ,CAAU,yGAAV,CAAN;AACH;AACJ;;AAED,yBAASkB,8BAAT,CAAwCC,UAAxC,EAAoD;AAChD,2BAAOA,WACF/E,GADE,CACE;AAAA,+BAAgB+E,WAAWlC,MAAX,CAAkB;AAAA,mCAAgBmC,aAAa9E,IAAb,KAAsB+E,aAAa/E,IAAnD;AAAA,yBAAlB,EAA2E8C,MAA3F;AAAA,qBADF,EAEFH,MAFE,CAEK;AAAA,+BAAoBqC,mBAAmB,CAAvC;AAAA,qBAFL,EAE+ClC,MAF/C,GAEwD,CAF/D;AAGH;AACJ,aA1CE,CAAP;AA2CH;;+BAEDhB,+DAA0BpB,SAAS;AAC/B,mBAAO,KAAKoD,oBAAL,CAA0BhC,yBAA1B,CAAoDpB,OAApD,EACFC,IADE,CACG;AAAA,uBAAuBuD,oBACxBpE,GADwB,CACpB,8BAAsB;AACvB2E,uCAAmBb,aAAnB,GAAmC,IAAnC;AACA,2BAAOa,kBAAP;AACH,iBAJwB,CAAvB;AAAA,aADH,CAAP;AAMH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MC3DQQ,iCAAAA;;;;;qCACX3C,uBAAML,KAAK;AACT,UAAIA,IAAIsB,QAAJ,CAAa,eAAb,CAAJ,EAAmC;AACjC,eAAOvC,QAAQkE,OAAR,CAAgB,EAAC1C,MAAM;AAAA;AAAA,WAAP,EAAhB,CAAP;AACD;AACD,UAAIP,IAAIsB,QAAJ,CAAa,cAAb,CAAJ,EAAkC;AAChC,eAAOvC,QAAQkE,OAAR,CAAgB,EAAC1C,MAAM;AAAA;AAAA,WAAP,EAAhB,CAAP;AACD;AACD,YAAM,IAAIkB,KAAJ,CAAU,gDAAgDzB,GAA1D,CAAN;AACD;;;;;AACF;;;;;;;;oBCbc;AACb,iBAAa,CACX;AACE,cAAQ,SADV;AAEE,gBAAU;AACR,iBAAS,CACP;AACE,oBAAU,cADZ;AAEE,oBAAU,SAFZ;AAGE,wBAAc;AAHhB,SADO;AADD;AAFZ,KADW,EAaX;AACE,cAAQ,SADV;AAEE,gBAAU;AACR,iBAAS,CACP;AACE,oBAAU,gBADZ;AAEE,oBAAU,SAFZ;AAGE,wBAAc;AAHhB,SADO;AADD;AAFZ,KAbW,EAyBX;AACE,cAAQ,SADV;AAEE,gBAAU;AACR,iBAAS,CACP;AACE,oBAAU,KADZ;AAEE,oBAAU,SAFZ;AAGE,wBAAc;AAHhB,SADO;AADD;AAFZ,KAzBW,EAqCX;AACE,cAAQ,SADV;AAEE,gBAAU;AACR,iBAAS,CACP;AACE,oBAAU,cADZ;AAEE,oBAAU,SAFZ;AAGE,wBAAc;AAHhB,SADO;AADD;AAFZ,KArCW,EAiDX;AACE,cAAQ,SADV;AAEE,gBAAU;AACR,iBAAS,CACP;AACE,oBAAU,cADZ;AAEE,oBAAU,SAFZ;AAGE,wBAAc;AAHhB,SADO;AADD;AAFZ,KAjDW,EA6DX;AACE,cAAQ,SADV;AAEE,gBAAU;AACR,iBAAS,CACP;AACE,oBAAU,cADZ;AAEE,oBAAU,SAFZ;AAGE,wBAAc;AAHhB,SADO;AADD;AAFZ,KA7DW,EAyEX;AACE,cAAQ,SADV;AAEE,gBAAU;AACR,iBAAS,CACP;AACE,oBAAU,cADZ;AAEE,oBAAU,SAFZ;AAGE,wBAAc;AAHhB,SADO;AADD;AAFZ,KAzEW,EAqFX;AACE,cAAQ,SADV;AAEE,gBAAU;AACR,iBAAS,CACP;AACE,oBAAU,cADZ;AAEE,oBAAU,SAFZ;AAGE,wBAAc;AAHhB,SADO;AADD;AAFZ,KArFW,EAiGX;AACE,cAAQ,SADV;AAEE,gBAAU;AACR,iBAAS,CACP;AACE,oBAAU,cADZ;AAEE,oBAAU,SAFZ;AAGE,wBAAc;AAHhB,SADO;AADD;AAFZ,KAjGW,EA6GX;AACE,cAAQ,UADV;AAEE,gBAAU;AACR,iBAAS,CACP;AACE,oBAAU,WADZ;AAEE,oBAAU,SAFZ;AAGE,wBAAc;AAHhB,SADO;AADD;AAFZ,KA7GW;AADA;;;;;;;;oBCAA;AACb,iBAAa,CACX;AACE,cAAQ,SADV;AAEE,gBAAU;AACR,iBAAS,CACP;AACE,oBAAU,cADZ;AAEE,oBAAU,SAFZ;AAGE,wBAAc;AAHhB,SADO;AADD;AAFZ,KADW,EAaX;AACE,cAAQ,UADV;AAEE,gBAAU;AACR,iBAAS,CACP;AACE,oBAAU,gBADZ;AAEE,oBAAU,SAFZ;AAGE,wBAAc;AAHhB,SADO;AADD;AAFZ,KAbW,EAyBX;AACE,cAAQ,SADV;AAEE,gBAAU;AACR,iBAAS,CACP;AACE,oBAAU,KADZ;AAEE,oBAAU,SAFZ;AAGE,wBAAc;AAHhB,SADO;AADD;AAFZ,KAzBW,EAqCX;AACE,cAAQ,SADV;AAEE,gBAAU;AACR,iBAAS,CACP;AACE,oBAAU,cADZ;AAEE,oBAAU,SAFZ;AAGE,wBAAc;AAHhB,SADO;AADD;AAFZ,KArCW;AADA;;ACAf;ACAA;ACAA;ACAA;ACAA","file":"app-bundle.js","sourcesContent":["export class App {\n  configureRouter(config, router) {\n    this.router = router;\n    config.title = 'Teamcity radiator';\n    config.map([\n      { route: 'failed/:baseUrl', name: 'Faled Build Overview', moduleId: 'failed-build-overview' },\n      { route: 'running/:baseUrl', name: 'Running Build Overview', moduleId: 'running-build-overview' },\n    ]);\n  }\n}","export default {\n  debug: true,\n  testing: true\n};\n","import { BuildService } from 'services/build-service';\nimport { inject } from 'aurelia-framework';\n\n@inject(BuildService)\nexport class FailedBuildOverview {\n  constructor(service) {\n    this.service = service;\n  }\n\n  activate(params) {\n    function setAllFailedBuilds(params) {\n      this.service\n        .getAllFailedBuilds(params.baseUrl)\n        .then(builds => { this.builds = builds; });\n    }\n\n    setAllFailedBuilds.bind(this)(params);\n    setInterval(setAllFailedBuilds.bind(this), 30000, params);\n  }\n}\n","import environment from './environment';\n\n//Configure Bluebird Promises.\n//Note: You may want to use environment-specific configuration.\nPromise.config({\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","import { BuildService } from 'services/build-service';\nimport { inject } from 'aurelia-framework';\n\n@inject(BuildService)\nexport class RunningBuildOverview {\n  constructor(buildService) {\n    this.buildService = buildService;\n  }\n\n  activate(params) {\n    function setAllRunningBuilds(params) {\n      this.buildService\n        .getAllLatestRunningBuilds(params.baseUrl)\n        .then(builds => { this.builds = builds; });\n    }\n\n    setAllRunningBuilds.bind(this)(params);\n    setInterval(setAllRunningBuilds.bind(this), 30000, params);\n  }\n}\n","import { HttpClientRouter } from '../communicationlayer/http-client-router';\nimport { inject } from 'aurelia-framework';\n\nfunction fetchBuildArray(clientRouter, url) {\n  let init = {\n    method: 'GET',\n    headers: new Headers({\n      'Accept': 'application/json',\n      'X-Requested-With': 'Fetch',\n    })\n  };\n\n  return clientRouter.fetch(url, init)\n    .then(response => response.json())\n    .then(jsonResponse =>\n      jsonResponse.buildType\n        .filter(buildTypeElement => buildTypeElement.builds.build.length > 0)\n        .map(buildTypeElement => {\n          return {\n            \"name\": buildTypeElement.name,\n            \"buildNumber\": buildTypeElement.builds.build[0].number,\n            \"status\": buildTypeElement.builds.build[0].status,\n            \"statusText\": buildTypeElement.builds.build[0].statusText,\n            \"drawAttention\": false\n          }\n        })\n    );\n}\n\n@inject(HttpClientRouter)\nexport class TeamcityBuildAdapter {\n  constructor(clientRouter) {\n    this.clientRouter = clientRouter;\n  }\n\n  getAllLatestFinishedBuilds(baseUrl) {\n    let url = 'http://' + baseUrl + '/guestAuth/app/rest/buildTypes?locator=affectedProject:(id:_Root)&fields=buildType(id,name,builds($locator(running:false,canceled:false,count:1),build(number,status,statusText)))';\n    return fetchBuildArray(this.clientRouter, url);\n  }\n\n  getAllLatestRunningBuilds(baseUrl) {\n    let url = 'http://' + baseUrl + '/guestAuth/app/rest/buildTypes?locator=affectedProject:(id:_Root)&fields=buildType(id,name,builds($locator(running:true,canceled:false,count:1),build(number,status,statusText)))';\n    return fetchBuildArray(this.clientRouter, url);\n  }\n}\n","import { HttpClient } from 'aurelia-fetch-client';\nimport { TeamCityHttpClientStub } from './teamcitystub/team-city-http-client-stub';\nimport { inject } from 'aurelia-framework';\n\n@inject(HttpClient, TeamCityHttpClientStub)\nexport class HttpClientRouter {\n    constructor(realHttpClient, teamCityHttpClientStub) {\n        this.realHttpClient = realHttpClient;\n        this.teamCityHttpClientStub = teamCityHttpClientStub;\n    }\n\n    fetch(url, init) {\n        return url.includes('stub') ? this.teamCityHttpClientStub.fetch(url) : this.realHttpClient.fetch(url, init);\n    }\n}\n","import { bindable } from 'aurelia-framework';\n\nexport class BuildOverview {\n    @bindable builds;\n\n    getBuildStatusCssClass(build) {\n        if (build.status === 'SUCCESS') {\n            return 'alert-success';\n        }\n        if (build.status === 'FAILURE') {\n            return 'alert-danger';\n        }\n        throw new Error('The buildstatus \"' + build.status + '\" is invalid')\n    }\n\n    getDrawAttentionCssClass(build) {\n        if (build.drawAttention === true) {\n            return 'draw-attention';\n        }\n        if (build.drawAttention === false) {\n            return '';\n        }\n        throw new Error('The drawAttention \"' + build.drawAttention + '\" is invalid')\n    }\n}\n","export function configure(config) {\n  //config.globalResources([]);\n}\n","import { TeamcityBuildAdapter } from '../anticorruptionlayer/teamcity-build-adapter';\nimport { inject } from 'aurelia-framework';\n\n@inject(TeamcityBuildAdapter)\nexport class BuildService {\n    constructor(teamcityBuildAdapter) {\n        this.teamcityBuildAdapter = teamcityBuildAdapter;\n    }\n\n    getAllFailedBuilds(baseUrl) {\n        return Promise.all([this.teamcityBuildAdapter.getAllLatestFinishedBuilds(baseUrl), this.teamcityBuildAdapter.getAllLatestRunningBuilds(baseUrl)])\n            .then(buildArrays => {\n\n                let latestFinishedBuilds = buildArrays[0];\n                let latestRunningBuilds = buildArrays[1];\n\n                validateFailedBuilds();\n                validateRunningBuilds();\n\n                return latestFinishedBuilds\n                    .filter(finishedBuild => finishedBuild.status === 'FAILURE')\n                    .map(failedBuild => {\n                        failedBuild.drawAttention = isNewBuildRunning();\n                        return failedBuild;\n\n                        function isNewBuildRunning() {\n\n                            function getCorrespondingBuild() {\n                                return latestRunningBuilds.filter(latestRunningBuild => latestRunningBuild.name === failedBuild.name)[0];\n                            }\n\n                            return getCorrespondingBuild() !== undefined && getCorrespondingBuild().buildNumber > failedBuild.buildNumber;\n                        }\n                    });\n\n                function validateFailedBuilds() {\n                    if (haveDuplicateNamesInBuildArray(latestFinishedBuilds)) {\n                        throw new Error(\"There are failed builds with the same name. We didn't foresee this to happen. Sorry. Please contact us\");\n                    }\n                }\n\n                function validateRunningBuilds() {\n                    if (haveDuplicateNamesInBuildArray(latestRunningBuilds)) {\n                        throw new Error(\"There are running builds with the same name. We didn't foresee this to happen. Sorry. Please contact us\");\n                    }\n                }\n\n                function haveDuplicateNamesInBuildArray(buildArray) {\n                    return buildArray\n                        .map(failedBuild1 => buildArray.filter(failedBuild2 => failedBuild1.name === failedBuild2.name).length)\n                        .filter(occurancesOfName => occurancesOfName > 1).length > 1;\n                }\n            });\n    }\n\n    getAllLatestRunningBuilds(baseUrl) {\n        return this.teamcityBuildAdapter.getAllLatestRunningBuilds(baseUrl)\n            .then(latestRunningBuilds => latestRunningBuilds\n                .map(latestRunningBuild => {\n                    latestRunningBuild.drawAttention = true;\n                    return latestRunningBuild;\n                }));\n    }\n}\n","import teamCitylatestBuildsResponse from './team-city-latest-builds-response';\nimport teamCitylatestRunningBuildsResponse from './team-city-latest-running-builds-response';\n\nexport class TeamCityHttpClientStub {\n  fetch(url) {\n    if (url.includes('running:false')) {\n      return Promise.resolve({json: () => teamCitylatestBuildsResponse});\n    }\n    if (url.includes('running:true')) {\n      return Promise.resolve({json: () => teamCitylatestRunningBuildsResponse});\n    }\n    throw new Error(\"team city http client stub doesn't support \" + url);\n  }\n};\n","export default {\n  \"buildType\": [\n    {\n      \"name\": \"build 1\",\n      \"builds\": {\n        \"build\": [\n          {\n            \"number\": \"3.1.70.17327\",\n            \"status\": \"FAILURE\",\n            \"statusText\": \"Tests passed: 198, ignored: 9\"\n          }\n        ]\n      }\n    },\n    {\n      \"name\": \"build 2\",\n      \"builds\": {\n        \"build\": [\n          {\n            \"number\": \"3.1.6965.17318\",\n            \"status\": \"SUCCESS\",\n            \"statusText\": \"Tests passed: 2391, ignored: 6\"\n          }\n        ]\n      }\n    },\n    {\n      \"name\": \"build 3\",\n      \"builds\": {\n        \"build\": [\n          {\n            \"number\": \"123\",\n            \"status\": \"SUCCESS\",\n            \"statusText\": \"Tests passed: 35\"\n          }\n        ]\n      }\n    },\n    {\n      \"name\": \"build 4\",\n      \"builds\": {\n        \"build\": [\n          {\n            \"number\": \"3.1.54.17253\",\n            \"status\": \"SUCCESS\",\n            \"statusText\": \"Tests passed: 35\"\n          }\n        ]\n      }\n    },\n    {\n      \"name\": \"build 5\",\n      \"builds\": {\n        \"build\": [\n          {\n            \"number\": \"3.1.54.17287\",\n            \"status\": \"FAILURE\",\n            \"statusText\": \"Tests failed: 4 (1 new), passed: 31\"\n          }\n        ]\n      }\n    },\n    {\n      \"name\": \"build 6\",\n      \"builds\": {\n        \"build\": [\n          {\n            \"number\": \"1.2.54.17287\",\n            \"status\": \"FAILURE\",\n            \"statusText\": \"Tests failed: 2, passed: 33; snapshot dependency failed: Main :: Data Quality Tests :: build 6\"\n          }\n        ]\n      }\n    },\n    {\n      \"name\": \"build 7\",\n      \"builds\": {\n        \"build\": [\n          {\n            \"number\": \"3.5.54.17287\",\n            \"status\": \"FAILURE\",\n            \"statusText\": \"Tests failed: 3, passed: 32; snapshot dependency failed: Main :: Data Quality Tests :: build 7\"\n          }\n        ]\n      }\n    },\n    {\n      \"name\": \"build 8\",\n      \"builds\": {\n        \"build\": [\n          {\n            \"number\": \"3.5.87.17287\",\n            \"status\": \"SUCCESS\",\n            \"statusText\": \"Tests failed: 8 (1 new), passed: 27; snapshot dependency failed: Main :: Data Quality Tests :: build 8\"\n          }\n        ]\n      }\n    },\n    {\n      \"name\": \"build 9\",\n      \"builds\": {\n        \"build\": [\n          {\n            \"number\": \"3.5.99.17287\",\n            \"status\": \"FAILURE\",\n            \"statusText\": \"Tests failed: 13, passed: 22; snapshot dependency failed: Main :: Data Quality Tests :: build 9\"\n          }\n        ]\n      }\n    },\n    {\n      \"name\": \"build 10\",\n      \"builds\": {\n        \"build\": [\n          {\n            \"number\": \"3.5.99.21\",\n            \"status\": \"FAILURE\",\n            \"statusText\": \"Tests failed: 10, passed: 25\"\n          }\n        ]\n      }\n    }\n  ]\n};","export default {\n  \"buildType\": [\n    {\n      \"name\": \"build 1\",\n      \"builds\": {\n        \"build\": [\n          {\n            \"number\": \"3.1.70.17328\",\n            \"status\": \"SUCCESS\",\n            \"statusText\": \"Tests passed: 198, ignored: 9\"\n          }\n        ]\n      }\n    },\n    {\n      \"name\": \"build 25\",\n      \"builds\": {\n        \"build\": [\n          {\n            \"number\": \"3.1.6965.17318\",\n            \"status\": \"SUCCESS\",\n            \"statusText\": \"Tests passed: 2391, ignored: 6\"\n          }\n        ]\n      }\n    },\n    {\n      \"name\": \"build 3\",\n      \"builds\": {\n        \"build\": [\n          {\n            \"number\": \"120\",\n            \"status\": \"FAILURE\",\n            \"statusText\": \"Tests passed: 35\"\n          }\n        ]\n      }\n    },\n    {\n      \"name\": \"build 4\",\n      \"builds\": {\n        \"build\": [\n          {\n            \"number\": \"3.1.54.17255\",\n            \"status\": \"FAILURE\",\n            \"statusText\": \"Tests passed: 35\"\n          }\n        ]\n      }\n    }]\n};",null,null,null,null,null],"sourceRoot":"../src"}